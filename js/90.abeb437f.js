"use strict";(self["webpackChunkvue_router_demo"]=self["webpackChunkvue_router_demo"]||[]).push([[90],{2090:function(t,e,o){o.r(e),o.d(e,{default:function(){return h}});var a=function(){var t=this,e=t._self._c;return e("div",[e("ul",t._l(t.posts,(function(o){return e("li",{key:o.id},[e("router-link",{attrs:{to:{name:"post",params:{postId:o.id}}}},[t._v(t._s(o.title))])],1)})),0)])},s=[];const n=function(){return document.documentElement.scrollTop},l=function(){return document.documentElement.scrollHeight},i=function(){return document.documentElement.clientHeight};var r={props:["tab"],data(){return{posts:[],page:1,pageNumbers:[{tab:"good",total:720},{tab:"all",total:280},{tab:"share",total:200},{tab:"ask",total:80},{tab:"job",total:80},{tab:"dev",total:280}],loading:!1}},computed:{total(){const t=this.tab?this.tab:"all";return this.pageNumbers.find((e=>e.tab===t)).total}},watch:{tab:{async handler(t){const e=await this.$http.get(`/topics?tab=${t||"all"}`);this.posts=e.data},immediate:!0}},mounted(){window.addEventListener("scroll",this.load)},methods:{async load(){if(this.posts.length){const t=l()-i()-n();if(t<=20&&!this.loading){console.log("加载中"),this.loading=!0,this.page++;const t=await this.$http.get(`/topics?tab=${this.tab?this.tab:"all"}&page=${this.page}`);console.log("加载完毕"),this.loading=!1,this.posts=[...this.posts,...t.data]}}}},destroyed(){window.removeEventListener("scroll",this.load)}},d=r,u=o(1001),c=(0,u.Z)(d,a,s,!1,null,"93161dc8",null),h=c.exports}}]);
//# sourceMappingURL=90.abeb437f.js.map